@page "/v/images"
@using Fordele.Blazor.Backend.Interfaces;
@using Fordele.Blazor.Backend.Services;
@attribute [Authorize]

<PageTitle>Bilder</PageTitle>

<h1>Alle Bilder</h1>

<div class="row">
    <div class="col">
        @for (int i = 0; i < UploadedImages.Count(); i += 3)
        {
            <ImageCard UploadedImage="@UploadedImages[i]" />
        }
    </div>
    <div class="col">
        @for (int i = 1; i < UploadedImages.Count(); i += 3)
        {
            <ImageCard UploadedImage="@UploadedImages[i]" />
        }
    </div>
    <div class="col">
        @for (int i = 2; i < UploadedImages.Count(); i += 3)
        {
            <ImageCard UploadedImage="@UploadedImages[i]" />
        }
    </div>
</div>

@code {
    [Inject]
    public UploadedFileService UploadedFileService { get; set; } = null!;

    [Parameter]
    public Guid Id { get; set; }

    private IUploadedFile[] UploadedImages { get; set; } = null!;

    protected override void OnInitialized()
    {
        UploadedImages = UploadedFileService.GetUploadedImages()
            .OrderByDescending(uploadedImage => uploadedImage.ModifiedAt).ToArray();

        base.OnInitialized();
    }
}
